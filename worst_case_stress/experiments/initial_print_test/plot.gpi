set term pngcairo size 1024,768

set grid;
set xlabel 'Smoothness Parameter (Lower = Smoother)';
unset key;

# set output 'plot_wcs.png';
# set ylabel 'Peak Worst-Case Microscopic';
# set title 'Test Pattern Worst-Case (Frobenius) Stresses';
# plot 'data.txt' u 1:2 w lp ps 2;

# set output 'plot_pull_y.png';
# set ylabel 'Peak Stress';
# set title 'Test Pattern Peak Max Stresses, Y Stretch Experiment'
# plot 'data.txt' u 1:3 w lp ps 2;
# 
# set output 'plot_pull_xy.png';
# set ylabel 'Peak Stress';
# set title 'Test Pattern Peak Max Stresses, XY Stretch Experiment'
# plot 'data.txt' u 1:4 w lp ps 2;

set output 'plot_rel_dirichlet_pully.png';
set ylabel 'Relative Stress Measure';
set key
set title 'Dirichlet Test Pattern Peak Stress Measurements, Relative to Strongest'

ds='dirichlet_experiment.dat'

stats ds u 2 name "WCS" nooutput;
stats ds u 3 name "PullY1" nooutput;
stats ds u 5 name "PullY2" nooutput;
stats ds u 7 name "PullY4" nooutput;
stats ds u 9 name "PullY8" nooutput;

plot ds u 1:(($2 / WCS_min)) w lp ps 2 title 'Worst-Case (Frobenius)', \
     ds u 1:(($3 / PullY1_min)) w lp ps 2 title '1x1 Pull Y (Max Stress)', \
     ds u 1:(($5 / PullY2_min)) w lp ps 2 title '2x2 Pull Y (Max Stress)', \
     ds u 1:(($7 / PullY4_min)) w lp ps 2 title '4x4 Pull Y (Max Stress)', \
     ds u 1:(($9 / PullY8_min)) w lp ps 2 title '8x8 Pull Y (Max Stress)'

set output 'plot_abs_dirichlet_pully.png';
set ylabel 'Peak Stress Measure (MPa)';
set title 'Dirichlet Test Pattern Peak Stress Measurements'
set key

plot ds u 1:3 w lp ps 2 title '1x1 Pull Y (Max Stress)', \
     ds u 1:5 w lp ps 2 title '2x2 Pull Y (Max Stress)', \
     ds u 1:7 w lp ps 2 title '4x4 Pull Y (Max Stress)', \
     ds u 1:9 w lp ps 2 title '8x8 Pull Y (Max Stress)'
